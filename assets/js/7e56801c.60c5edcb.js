(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{88:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return o})),t.d(n,"metadata",(function(){return a})),t.d(n,"toc",(function(){return c})),t.d(n,"default",(function(){return u}));var i=t(3),r=t(7),l=(t(0),t(111)),o={title:"Electron",slug:"/electron"},a={unversionedId:"StackTech/electron",id:"StackTech/electron",isDocsHomePage:!1,title:"Electron",description:"KEZAKO ?",source:"@site/docs/StackTech/electron.md",slug:"/electron",permalink:"/UnlabeledProject/docs/electron",editUrl:"https://github.com/batleforc/UnlabeledProject/edit/doc/docs/StackTech/electron.md",version:"current",sidebar:"docs",previous:{title:"Stach technique",permalink:"/UnlabeledProject/docs/stacktechnique"},next:{title:"Mise en place de l'environnement",permalink:"/UnlabeledProject/docs/setup"}},c=[{value:"Mise en place d&#39;un environnement de dev",id:"mise-en-place-dun-environnement-de-dev",children:[{value:"1. Installation des packages",id:"1-installation-des-packages",children:[]},{value:"2. Un peu de configuration",id:"2-un-peu-de-configuration",children:[]},{value:"3. Ajout des scripts",id:"3-ajout-des-scripts",children:[]},{value:"4. electron.js",id:"4-electronjs",children:[]},{value:"How It Work",id:"how-it-work",children:[]}]}],s={toc:c};function u(e){var n=e.components,t=Object(r.a)(e,["components"]);return Object(l.b)("wrapper",Object(i.a)({},s,t,{components:n,mdxType:"MDXLayout"}),Object(l.b)("p",null,"KEZAKO ?"),Object(l.b)("p",null,"Cette partie d'atome est un framework permettant de d\xe9velopper des applications desktop multi-plateformes \xe0 partir de JavaScript/Html/CSS."),Object(l.b)("p",null,'Le processus de d\xe9veloppement est "Simple".'),Object(l.b)("h2",{id:"mise-en-place-dun-environnement-de-dev"},"Mise en place d'un environnement de dev"),Object(l.b)("p",null,":::Info"),Object(l.b)("p",null,"Pour la suite de cette page je pars du principe qu'on ajoute la stack electron sur un projet d\xe9j\xe0 existant, dans une autre doc j'explique la mise en place de mon environnement post electron."),Object(l.b)("p",null,"L'environnement ",Object(l.b)("a",{parentName:"p",href:"/docs/setup"},"pr\xe9-electron est disponible ici")),Object(l.b)("p",null,":::"),Object(l.b)("h3",{id:"1-installation-des-packages"},"1. Installation des packages"),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-shell"},"  yarn add electron electron-builder wait-on concurrently electron-is-dev\n")),Object(l.b)("p",null,"Electron permet de lancer la solution sans construire (build) la solution compl\xe8te."),Object(l.b)("p",null,"Electron-Builder permet de compiler la solution."),Object(l.b)("p",null,"\"Wait-On\" permet d'attendre une r\xe9ponse d'une url sp\xe9cifique pour ici continuer le processus."),Object(l.b)("p",null,'"Concurrently" permet de lancer plusieures commandes aux m\xeame moment.'),Object(l.b)("h3",{id:"2-un-peu-de-configuration"},"2. Un peu de configuration"),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-json",metastring:'title="package.json"',title:'"package.json"'},'{\n  ... le reste de votre package.json\n  "main": "./build/electron.js",\n  "build": {\n    "productName": "unlabeledProject",\n    "appId": "com.example.unlabeledProject",\n    "icon": "build/toolbox.png",\n    "asar": true,\n    "files": [\n      "package.json",\n      "build/**/*",\n      "node_modules/**/*",\n      "BuildServer/**/*"\n    ]\n  },\n}\n')),Object(l.b)("p",null,"Toutes ces lignes sont-elles vraiment n\xe9cessaires ?"),Object(l.b)("p",null,"Dans notre cas oui, mais je suis l\xe0 pour vous les expliquer:"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},"main : L'emplacement de votre fichier electron.js, celui-ci est le point d'entr\xe9e de votre application (imaginez cliquer sur ce fichier quand vous lancer la solution finale ou uniquement en dev)"),Object(l.b)("li",{parentName:"ul"},"build:",Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},"productName : Le nom de votre produit (sera utilis\xe9 pour la compilation de votre ex\xe9cutable)"),Object(l.b)("li",{parentName:"ul"},"appId : Id Linux/Apple, cette id permet de reconna\xeetre le package."),Object(l.b)("li",{parentName:"ul"},"icon : L'icon utiliser pour vos ex\xe9cutables (penser \xe0 bien importer le dossier o\xf9 il est dans les fichiers)"),Object(l.b)("li",{parentName:"ul"},"asar : Si vous utilisez le format asar pour vos fichiers compress\xe9s. Th\xe9oriquement il acc\xe9l\xe8re les requires."),Object(l.b)("li",{parentName:"ul"},"files: Tous les fichiers/dossiers incluent dans le package finale, penser \xe0 include le node_modules, vos ou votre dossier(s) de source ainsi que votre icon (ici, build contient le client ainsi que l'icon)")))),Object(l.b)("h3",{id:"3-ajout-des-scripts"},"3. Ajout des scripts"),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-json",metastring:'title="package.json"',title:'"package.json"'},'{\n  ... le reste de votre package.json\n  "scripts":{\n    "start":"VOTRE SCRIPT DE STARTUP",\n    "build":"VOTRE SCRIPT DE BUILD",\n    "postinstall": "electron-builder install-app-deps",\n    "electronDev": "concurrently \\"yarn start\\" \\"wait-on http://localhost:3000 && electron .\\"",\n    "electronAlone":"electron .",\n    "ebuild": "yarn run build && node_modules/.bin/build",\n    "electron-pack": "build --em.main=build/electron.js",\n    "pack": "electron-builder --dir",\n    "dist": "electron-builder",\n    "distStartup":"yarn build && yarn dist"\n  }\n}\n')),Object(l.b)("p",null,"Pour le bon fonctionnement de la solution TOUS ces scripts sont n\xe9cessaires:"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},"postinstall : Est ex\xe9cut\xe9 apr\xe8s l'installation d'un package, il permet de reconstruire les extensions dans un format propice \xe0 l'utilisation electron."),Object(l.b)("li",{parentName:"ul"},"electronDev : Permet de lancer votre environnement de dev via start puis d'attendre que celui-ci soit lanc\xe9 pour lancer le client electron."),Object(l.b)("li",{parentName:"ul"},"electronAlone : Dans beaucoup de cas j'ai eu \xe0 modifier uniquement la partie electron, afin d'acc\xe9l\xe9rer les starts/restarts je lan\xe7ais une fois unique start puis relan\xe7ais uniquement la partie electron."),Object(l.b)("li",{parentName:"ul"},"pack : Permet d'obtenir uniquement le dossier contenant la solution compil\xe9e."),Object(l.b)("li",{parentName:"ul"},"dist : Permet via la configuration de l'\xe9tape 2 de compiler vos fichiers (par d\xe9fault .snap pour linux, .exe pour windows et .appImage pour mac)"),Object(l.b)("li",{parentName:"ul"},"distStartup : Permet en une commande de build les composants ainsi que le client electron.")),Object(l.b)("h3",{id:"4-electronjs"},"4. electron.js"),Object(l.b)("p",null,"Je vous fournis une version simplifi\xe9e de mon fichier electronJs les commentaires sont int\xe9gr\xe9s dans le code fournis, si vous souhaitez mettre en place un syst\xe8me plus complet avec un icon tray, veuillez vous en r\xe9f\xe9rer \xe0 mon code."),Object(l.b)("p",null,"Le code electron.js est plac\xe9 dans mon dossier public afin d'\xe9viter que celui ci sois modifi\xe9, ne comptez pas sur du TypeScript pour celui ci."),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-js",metastring:'title="/public/electron.js"',title:'"/public/electron.js"'},'  const electron = require("electron");\n  const { app, BrowserWindow } = electron;\n  const isDev = require("electron-is-dev");\n  const Server = require(\'../BuildServer/index\') // permet de lancer le serveur aux d\xe9marrage\n  const path = require("path");\n  let mainWindow;\n  const BaseFolder = path.join(__dirname);\n  const icon = path.join(BaseFolder,"toolbox.png");\n\n  const createWindow = ({showOnLoad = true}={}) => {\n    if(mainWindow){\n      mainWindow.focus();\n      return;\n    }\n    mainWindow = new BrowserWindow({\n      width: 1280, // Permet de d\xe9finir la taille de la fen\xeatre\n      height: 720,\n      autoHideMenuBar : true, // Permet de cacher la barre de menu int\xe9grer a electron\n      icon : icon // L\'icon de la fen\xeatre \xe9lectron\n    });\n    mainWindow.loadURL(\n      isDev ?\n        "http://localhost:3000" : // Le serveur de dev local\n        "http://localhost:5000"   // Le serveur de production\n    )\n    mainWindow.once("ready-to-show",()=>{\n      if(showOnLoad) mainWindow.show(); //si on veux montrer la fen\xeatre aux d\xe9marrage\n    })\n    mainWindow.once("closed", () => (mainWindow = null)); // si la fen\xeatre est fermer on vide mainWindow\n  }\n\n  const init = () => {\n    app.on("window-all-closed", (e) => e.preventDefault()); // evite que toute la solution sois fermer si toute les fen\xeatre sont fermer.\n  };\n  app.requestSingleInstanceLock() ? init() : app.quit(); // Evite d\'avoir deux fois le serveur d\xe9marrer\n  app.on("second-instance", () => mainWindow.show()); // montre la fen\xeatre si la solution est d\xe9marrer deux fois\n\n  app.on("ready",()=>{\n    if (mainWindow === null) {\n      createWindow(); // si aucune fen\xeatre en cr\xe9er une.\n    }\n  })\n\n  app.on("activate", () => {\n    if (mainWindow === null) {\n      createWindow(); // si aucune fen\xeatre en cr\xe9er une.\n    }\n  });\n')),Object(l.b)("h3",{id:"how-it-work"},"How It Work"),Object(l.b)("img",{src:"https://www.plantuml.com/plantuml/png/TP2z2W8n48Hxds8u2wiJrCv24B4JBIp58iOz38QDv99J45_8r_35N7_kJkKiKkomtsHc0QM3yuWv-HR0RakOMjB1EyPPbBUs95zGzBKmiOOuo7oHzw2HndHKiqFqkZF5cc0LScTZC8vbzMs4TDNUMANtQu5UNe9CJmUN2q7GZWDn9EH11QF_WALMavtnmSXo5IFzskgNaSItAjHa_56Z8TEHDhz_F2ymnA2xY8KdH2PanBTha26PIuM24gWiCtgdfEh3xLdw3W00",alt:null}),Object(l.b)("p",null,"Lors du d\xe9marrage de notre solution notre electron va d\xe9marrer notre serveur web, celui ci int\xe8gre une partie statique qui n'est autre que notre client ainsi qu'une partie Api."),Object(l.b)("h4",{id:"pourquoi-electron-et-pas-react-native"},"Pourquoi Electron et pas React-Native"),Object(l.b)("p",null,"React native et Electron n'ont pas le m\xeame objectif."),Object(l.b)("p",null,"React native vise les appareille Android et Ios contrairement a Electron qui vise les Ordinateur."))}u.isMDXComponent=!0}}]);